### Q: TypeScript 錯誤
A: 嘗試以下解決方案：
1. 執行 `npm run type-check` 檢查錯誤
2. 重新啟動 TypeScript 服務器（VS Code: Ctrl+Shift+P > "TypeScript: Restart TS Server"）
3. 刪除 `.next` 資料夾並重新啟動

### Q: Prisma 相關問題
A: 常見解決方案：
1. 執行 `npm run db:generate` 重新生成客戶端
2. 檢查 `DATABASE_URL` 環境變數
3. 執行 `npx prisma studio` 檢查資料庫狀態

## 部署問題

### Q: Vercel 部署失敗
A: 檢查項目：
1. 環境變數是否在 Vercel 中正確設定
2. 建置過程是否有錯誤
3. 依賴版本是否相容

### Q: API 路由 404 錯誤
A: 確認：
1. 路由文件路徑正確（app/api/...）
2. 函數導出格式正確（export async function GET）
3. 部署後路由是否正確註冊
```

---

## 🎯 效能最佳化指南

### ⚡ Next.js 效能優化
```typescript
// next.config.js
/** @type {import('next').NextConfig} */
const nextConfig = {
  // 實驗性功能
  experimental: {
    optimizePackageImports: ['@heroicons/react', 'lucide-react'],
  },
  
  // 圖片優化
  images: {
    domains: ['avatars.githubusercontent.com', 'images.unsplash.com'],
    formats: ['image/webp', 'image/avif'],
  },
  
  // 壓縮
  compress: true,
  
  // PWA 配置
  ...withPWA({
    dest: 'public',
    register: true,
    skipWaiting: true,
    runtimeCaching: [
      {
        urlPattern: /^https:\/\/api\.github\.com/,
        handler: 'CacheFirst',
        options: {
          cacheName: 'github-api-cache',
          expiration: {
            maxEntries: 50,
            maxAgeSeconds: 5 * 60, // 5 分鐘
          },
        },
      },
    ],
  }),
  
  // Bundle 分析
  ...(process.env.ANALYZE === 'true' && {
    webpack: (config) => {
      config.plugins.push(
        new (require('webpack-bundle-analyzer').BundleAnalyzerPlugin)({
          analyzerMode: 'server',
          analyzerPort: 8888,
          openAnalyzer: true,
        })
      )
      return config
    },
  }),
}

module.exports = nextConfig
```

### 🚀 React 組件優化
```typescript
// 使用 memo 避免不必要的重新渲染
import { memo, useMemo, useCallback } from 'react'

interface JobListProps {
  jobs: JobApplication[]
  onJobUpdate: (id: string, data: Partial<JobApplication>) => void
}

export const JobList = memo<JobListProps>(({ jobs, onJobUpdate }) => {
  // 使用 useMemo 優化昂貴的計算
  const sortedJobs = useMemo(() => {
    return jobs.sort((a, b) => 
      new Date(b.appliedAt).getTime() - new Date(a.appliedAt).getTime()
    )
  }, [jobs])
  
  // 使用 useCallback 穩定函數引用
  const handleJobEdit = useCallback((id: string, data: Partial<JobApplication>) => {
    onJobUpdate(id, data)
  }, [onJobUpdate])
  
  return (
    <div className="space-y-4">
      {sortedJobs.map(job => (
        <JobCard 
          key={job.id} 
          job={job} 
          onEdit={handleJobEdit}
        />
      ))}
    </div>
  )
})

// 使用 React.lazy 進行代碼分割
const PomodoroTimer = lazy(() => import('@/components/features/pomodoro/PomodoroTimer'))
const LearningChart = lazy(() => import('@/components/charts/LearningChart'))

// 在組件中使用 Suspense
export default function Dashboard() {
  return (
    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <Suspense fallback={<ChartSkeleton />}>
        <LearningChart />
      </Suspense>
      
      <Suspense fallback={<PomodoroSkeleton />}>
        <PomodoroTimer />
      </Suspense>
    </div>
  )
}
```

### 📊 資料獲取優化
```typescript
// 使用 TanStack Query 優化資料獲取
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'

// 查詢鍵常數
export const queryKeys = {
  jobs: ['jobs'] as const,
  jobsList: (filters: JobFilters) => [...queryKeys.jobs, 'list', filters] as const,
  jobDetail: (id: string) => [...queryKeys.jobs, 'detail', id] as const,
  jobStats: ['jobs', 'stats'] as const,
  
  learning: ['learning'] as const,
  learningStats: ['learning', 'stats'] as const,
  
  pomodoro: ['pomodoro'] as const,
  pomodoroHistory: (date: string) => [...queryKeys.pomodoro, 'history', date] as const,
} as const

// 自定義 hooks
export const useJobApplications = (filters: JobFilters) => {
  return useQuery({
    queryKey: queryKeys.jobsList(filters),
    queryFn: () => fetchJobApplications(filters),
    staleTime: 5 * 60 * 1000, // 5 分鐘
    gcTime: 10 * 60 * 1000,   // 10 分鐘
  })
}

export const useCreateJobApplication = () => {
  const queryClient = useQueryClient()
  
  return useMutation({
    mutationFn: createJobApplication,
    onSuccess: (newJob) => {
      // 樂觀更新
      queryClient.setQueryData(
        queryKeys.jobsList({}),
        (oldData: JobApplication[] | undefined) => 
          oldData ? [newJob, ...oldData] : [newJob]
      )
      
      // 重新獲取統計資料
      queryClient.invalidateQueries({
        queryKey: queryKeys.jobStats,
      })
    },
  })
}

// 預載入相關資料
export const usePrefetchJobDetail = () => {
  const queryClient = useQueryClient()
  
  return useCallback((jobId: string) => {
    queryClient.prefetchQuery({
      queryKey: queryKeys.jobDetail(jobId),
      queryFn: () => fetchJobApplication(jobId),
      staleTime: 5 * 60 * 1000,
    })
  }, [queryClient])
}
```

---

## 🛡️ 進階安全措施

### 🔐 內容安全政策 (CSP)
```typescript
// middleware.ts
import { NextResponse } from 'next/server'
import type { NextRequest } from 'next/server'

export function middleware(request: NextRequest) {
  const response = NextResponse.next()
  
  // 設定安全標頭
  response.headers.set('X-Content-Type-Options', 'nosniff')
  response.headers.set('X-Frame-Options', 'DENY')
  response.headers.set('X-XSS-Protection', '1; mode=block')
  response.headers.set('Referrer-Policy', 'strict-origin-when-cross-origin')
  
  // 內容安全政策
  const csp = [
    "default-src 'self'",
    "script-src 'self' 'unsafe-inline' 'unsafe-eval' https://va.vercel-scripts.com",
    "style-src 'self' 'unsafe-inline' https://fonts.googleapis.com",
    "font-src 'self' https://fonts.gstatic.com",
    "img-src 'self' data: https: blob:",
    "connect-src 'self' https://*.supabase.co https://api.github.com https://leetcode.com",
    "frame-src 'none'",
    "object-src 'none'",
    "base-uri 'self'",
    "form-action 'self'",
    "upgrade-insecure-requests",
  ].join('; ')
  
  response.headers.set('Content-Security-Policy', csp)
  
  return response
}

export const config = {
  matcher: [
    '/((?!api|_next/static|_next/image|favicon.ico).*)',
  ],
}
```

### 🔒 API 安全加固
```typescript
// lib/rateLimit.ts
import { LRUCache } from 'lru-cache'

type Options = {
  uniqueTokenPerInterval?: number
  interval?: number
}

export default function rateLimit(options?: Options) {
  const tokenCache = new LRUCache({
    max: options?.uniqueTokenPerInterval || 500,
    ttl: options?.interval || 60000,
  })

  return {
    check: (limit: number, token: string) =>
      new Promise<void>((resolve, reject) => {
        const tokenCount = (tokenCache.get(token) as number[]) || [0]
        if (tokenCount[0] === 0) {
          tokenCache.set(token, tokenCount)
        }
        tokenCount[0] += 1

        const currentUsage = tokenCount[0]
        const isRateLimited = currentUsage >= limit
        
        if (isRateLimited) {
          reject(new Error('Rate limit exceeded'))
        } else {
          resolve()
        }
      }),
  }
}

// 在 API 路由中使用
const limiter = rateLimit({
  interval: 60 * 1000, // 60 seconds
  uniqueTokenPerInterval: 500, // Limit 500 users per second
})

export async function POST(request: Request) {
  try {
    // 獲取客戶端 IP
    const ip = request.headers.get('x-forwarded-for') || 'unknown'
    
    // 檢查速率限制
    await limiter.check(10, ip) // 每分鐘 10 次請求
    
    // 處理請求...
  } catch (error) {
    return NextResponse.json(
      { error: 'Rate limit exceeded' },
      { status: 429 }
    )
  }
}
```

### 🛡️ 輸入清理與驗證
```typescript
// lib/sanitize.ts
import DOMPurify from 'isomorphic-dompurify'
import { z } from 'zod'

// 自定義 Zod 驗證器
const sanitizedString = (options?: { maxLength?: number }) =>
  z.string()
    .transform((str) => DOMPurify.sanitize(str.trim()))
    .refine((str) => str.length > 0, "String cannot be empty after sanitization")
    .refine(
      (str) => !options?.maxLength || str.length <= options.maxLength,
      `String must be ${options?.maxLength} characters or less`
    )

// 求職申請驗證 schema
export const JobApplicationSchema = z.object({
  company: sanitizedString({ maxLength: 100 }),
  position: sanitizedString({ maxLength: 200 }),
  salary: z.number().positive().optional(),
  status: z.enum(['applied', 'interview', 'offer', 'rejected']),
  appliedAt: z.coerce.date().max(new Date(), "Application date cannot be in the future"),
  interviewAt: z.coerce.date().optional(),
  notes: sanitizedString({ maxLength: 1000 }).optional(),
  url: z.string().url().optional().or(z.literal('')),
  source: sanitizedString({ maxLength: 50 }).optional(),
})

// 防止 SQL 注入的查詢建構器
export const buildSafeQuery = (
  baseQuery: string,
  filters: Record<string, any>,
  allowedFields: string[]
) => {
  const whereConditions: string[] = []
  const values: any[] = []
  let paramIndex = 1

  Object.entries(filters).forEach(([field, value]) => {
    if (allowedFields.includes(field) && value !== undefined) {
      whereConditions.push(`${field} = ${paramIndex}`)
      values.push(value)
      paramIndex++
    }
  })

  const query = whereConditions.length > 0
    ? `${baseQuery} WHERE ${whereConditions.join(' AND ')}`
    : baseQuery

  return { query, values }
}
```

---

## 📊 監控與分析

### 📈 效能監控設定
```typescript
// lib/analytics.ts
import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals'

interface AnalyticsEvent {
  name: string
  value: number
  rating: 'good' | 'needs-improvement' | 'poor'
  delta: number
  id: string
}

// 發送分析資料到後端
const sendToAnalytics = async (event: AnalyticsEvent) => {
  try {
    await fetch('/api/analytics', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        ...event,
        url: window.location.href,
        userAgent: navigator.userAgent,
        timestamp: new Date().toISOString(),
      }),
    })
  } catch (error) {
    console.error('Failed to send analytics:', error)
  }
}

// 監控 Web Vitals
export const initAnalytics = () => {
  getCLS(sendToAnalytics)
  getFID(sendToAnalytics)
  getFCP(sendToAnalytics)
  getLCP(sendToAnalytics)
  getTTFB(sendToAnalytics)
}

// 自定義事件追蹤
export const trackEvent = (eventName: string, properties?: Record<string, any>) => {
  if (typeof window !== 'undefined') {
    // Google Analytics 4
    if (window.gtag) {
      window.gtag('event', eventName, properties)
    }
    
    // 自定義分析
    fetch('/api/analytics/events', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        event: eventName,
        properties,
        timestamp: new Date().toISOString(),
        url: window.location.href,
      }),
    }).catch(console.error)
  }
}

// 使用範例
export const useAnalytics = () => {
  const trackJobApplication = useCallback((action: string, jobData?: any) => {
    trackEvent('job_application', {
      action,
      company: jobData?.company,
      position: jobData?.position,
      status: jobData?.status,
    })
  }, [])

  const trackPomodoroSession = useCallback((duration: number, completed: boolean) => {
    trackEvent('pomodoro_session', {
      duration,
      completed,
      type: 'work', // or 'break'
    })
  }, [])

  return {
    trackJobApplication,
    trackPomodoroSession,
  }
}
```

### 🐛 錯誤追蹤與日誌
```typescript
// lib/logger.ts
interface LogEntry {
  level: 'info' | 'warn' | 'error'
  message: string
  context?: Record<string, any>
  timestamp: Date
  userId?: string
  url?: string
}

class Logger {
  private isDevelopment = process.env.NODE_ENV === 'development'
  
  private formatMessage(entry: LogEntry): string {
    const timestamp = entry.timestamp.toISOString()
    const context = entry.context ? JSON.stringify(entry.context) : ''
    return `[${timestamp}] ${entry.level.toUpperCase()}: ${entry.message} ${context}`
  }
  
  private async sendToService(entry: LogEntry) {
    if (!this.isDevelopment) {
      try {
        // 發送到日誌服務（如 LogRocket, DataDog 等）
        await fetch('/api/logs', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(entry),
        })
      } catch (error) {
        console.error('Failed to send log:', error)
      }
    }
  }
  
  info(message: string, context?: Record<string, any>) {
    const entry: LogEntry = {
      level: 'info',
      message,
      context,
      timestamp: new Date(),
      url: typeof window !== 'undefined' ? window.location.href : undefined,
    }
    
    console.log(this.formatMessage(entry))
    this.sendToService(entry)
  }
  
  warn(message: string, context?: Record<string, any>) {
    const entry: LogEntry = {
      level: 'warn',
      message,
      context,
      timestamp: new Date(),
      url: typeof window !== 'undefined' ? window.location.href : undefined,
    }
    
    console.warn(this.formatMessage(entry))
    this.sendToService(entry)
  }
  
  error(message: string, error?: Error, context?: Record<string, any>) {
    const entry: LogEntry = {
      level: 'error',
      message,
      context: {
        ...context,
        error: error ? {
          name: error.name,
          message: error.message,
          stack: error.stack,
        } : undefined,
      },
      timestamp: new Date(),
      url: typeof window !== 'undefined' ? window.location.href : undefined,
    }
    
    console.error(this.formatMessage(entry))
    this.sendToService(entry)
    
    // 發送到 Sentry
    if (typeof window !== 'undefined' && window.Sentry) {
      window.Sentry.captureException(error || new Error(message), {
        contexts: { custom: context },
      })
    }
  }
}

export const logger = new Logger()

// React Error Boundary
export class ErrorBoundary extends React.Component<
  React.PropsWithChildren<{}>,
  { hasError: boolean }
> {
  constructor(props: React.PropsWithChildren<{}>) {
    super(props)
    this.state = { hasError: false }
  }

  static getDerivedStateFromError(error: Error): { hasError: boolean } {
    return { hasError: true }
  }

  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {
    logger.error('React Error Boundary caught an error', error, {
      componentStack: errorInfo.componentStack,
    })
  }

  render() {
    if (this.state.hasError) {
      return (
        <div className="min-h-screen flex items-center justify-center bg-gray-50">
          <div className="max-w-md w-full bg-white shadow-lg rounded-lg p-6">
            <div className="flex items-center mb-4">
              <XCircleIcon className="h-8 w-8 text-red-500 mr-3" />
              <h1 className="text-lg font-semibold text-gray-900">
                出了點問題
              </h1>
            </div>
            <p className="text-gray-600 mb-4">
              應用程式遇到了意外錯誤。我們已經記錄了這個問題，正在努力修復。
            </p>
            <button
              onClick={() => window.location.reload()}
              className="w-full bg-primary-600 text-white py-2 px-4 rounded-md hover:bg-primary-700 transition-colors"
            >
              重新載入頁面
            </button>
          </div>
        </div>
      )
    }

    return this.props.children
  }
}
```

---

## 🎨 品牌與設計指南

### 🎭 情感設計原則
```typescript
// 情感化設計配置
export const emotionalDesign = {
  // 心情色彩對應
  moodColors: {
    1: { bg: '#fef2f2', border: '#fecaca', text: '#dc2626' }, // 很糟糕 - 紅色
    2: { bg: '#fef3c7', border: '#fde68a', text: '#d97706' }, // 糟糕 - 橙色
    3: { bg: '#fef3c7', border: '#fde68a', text: '#d97706' }, // 不好 - 橙色
    4: { bg: '#fffbeb', border: '#fed7aa', text: '#ea580c' }, // 普通偏下 - 琥珀色
    5: { bg: '#f9fafb', border: '#d1d5db', text: '#6b7280' }, // 普通 - 灰色
    6: { bg: '#f0f9ff', border: '#bae6fd', text: '#0284c7' }, // 還行 - 藍色
    7: { bg: '#f0f9ff', border: '#bae6fd', text: '#0284c7' }, // 不錯 - 藍色
    8: { bg: '#f0fdf4', border: '#bbf7d0', text: '#16a34a' }, // 好 - 綠色
    9: { bg: '#f0fdf4', border: '#bbf7d0', text: '#16a34a' }, // 很好 - 綠色
    10: { bg: '#ecfdf5', border: '#86efac', text: '#059669' }, // 極好 - 翠綠色
  },
  
  // 求職狀態情感映射
  jobStatusEmotions: {
    applied: {
      emoji: '📤',
      message: '又一份履歷石沉大海...',
      color: '#8b5cf6',
      encouragement: '每一次投遞都是勇氣的體現！',
    },
    interview: {
      emoji: '🎤',
      message: '居然有公司要見你？！',
      color: '#f59e0b',
      encouragement: '準備好展現你的才華！',
    },
    offer: {
      emoji: '🎉',
      message: '奇蹟發生了！',
      color: '#10b981',
      encouragement: '恭喜！你的努力得到了回報！',
    },
    rejected: {
      emoji: '💔',
      message: '又一次成長的機會！',
      color: '#ef4444',
      encouragement: '拒絕不代表你不夠好，只是還沒遇到對的機會。',
    },
  },
  
  // 勵志語錄庫
  motivationalQuotes: [
    '每一次被拒絕，都讓你更接近那個會要你的公司。',
    '求職就像約會，你只需要找到一個對的就夠了。',
    '今天的拒絕是為了明天更好的機會讓路。',
    '你的價值不會因為一封拒絕信而減少。',
    '最好的工作機會往往在最不期待的時候出現。',
    '堅持比才華更重要，韌性比技能更珍貴。',
  ],
  
  // 成就系統設計
  achievements: [
    {
      id: 'first_application',
      title: '求職新手',
      description: '投遞第一份履歷',
      icon: '🌱',
      requirement: { type: 'job_count', value: 1 },
    },
    {
      id: 'persistent_applicant',
      title: '堅持不懈',
      description: '連續被拒絕 5 次仍不放棄',
      icon: '🔥',
      requirement: { type: 'consecutive_rejections', value: 5 },
    },
    {
      id: 'interview_master',
      title: '面試達人',
      description: '獲得第一個面試邀請',
      icon: '⭐',
      requirement: { type: 'interview_count', value: 1 },
    },
    {
      id: 'mood_stabilizer',
      title: '情緒管理大師',
      description: '心情指數連續 7 天保持在 6 以上',
      icon: '🧘',
      requirement: { type: 'stable_mood', value: 7, duration: 7 },
    },
    {
      id: 'pomodoro_warrior',
      title: '番茄戰士',
      description: '完成 100 個番茄鐘',
      icon: '🍅',
      requirement: { type: 'pomodoro_count', value: 100 },
    },
  ],
}

// 動態勵志訊息生成
export const generateMotivationalMessage = (userStats: UserStats): string => {
  const { jobStats, moodStats, studyStats } = userStats
  
  // 根據用戶狀況生成個性化訊息
  if (jobStats.recentRejections > 3) {
    return '看起來最近有點挫折，但記住：鑽石是在壓力下形成的！'
  }
  
  if (moodStats.averageMood < 5) {
    return '心情有點低落？來完成一個番茄鐘，讓成就感提振精神！'
  }
  
  if (studyStats.weeklyHours > 20) {
    return '你的學習熱忱令人敬佩！記得適度休息，效率比時長更重要。'
  }
  
  if (jobStats.interviewRate > 0.1) {
    return '你的面試邀請率很不錯！保持這個節奏，成功不遠了。'
  }
  
  const randomQuote = emotionalDesign.motivationalQuotes[
    Math.floor(Math.random() * emotionalDesign.motivationalQuotes.length)
  ]
  
  return randomQuote
}
```

---

## 🔄 持續改進策略

### 📊 A/B 測試框架
```typescript
// lib/experiments.ts
interface Experiment {
  id: string
  name: string
  description: string
  variants: {
    control: any
    treatment: any
  }
  allocation: number // 0-1, 測試組分配比例
  isActive: boolean
  startDate: Date
  endDate?: Date
}

class ExperimentManager {
  private experiments: Map<string, Experiment> = new Map()
  
  private getUserId(): string {
    // 從認證系統獲取用戶 ID，或使用 localStorage 的匿名 ID
    return localStorage.getItem('anonymous_id') || this.generateAnonymousId()
  }
  
  private generateAnonymousId(): string {
    const id = crypto.randomUUID()
    localStorage.setItem('anonymous_id', id)
    return id
  }
  
  private hashUserId(userId: string, experimentId: string): number {
    // 使用簡單的雜湊函數確保用戶始終進入相同的變體組
    let hash = 0
    const str = userId + experimentId
    for (let i = 0; i < str.length; i++) {
      const char = str.charCodeAt(i)
      hash = ((hash << 5) - hash) + char
      hash = hash & hash // 轉換為 32 位整數
    }
    return Math.abs(hash)
  }
  
  getVariant(experimentId: string): 'control' | 'treatment' | null {
    const experiment = this.experiments.get(experimentId)
    if (!experiment || !experiment.isActive) {
      return null
    }
    
    const userId = this.getUserId()
    const hash = this.hashUserId(userId, experimentId)
    const bucket = (hash % 100) / 100
    
    return bucket < experiment.allocation ? 'treatment' : 'control'
  }
  
  trackConversion(experimentId: string, conversionEvent: string) {
    const variant = this.getVariant(experimentId)
    if (!variant) return
    
    // 發送轉換事件到分析系統
    fetch('/api/experiments/conversion', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        experimentId,
        variant,
        conversionEvent,
        userId: this.getUserId(),
        timestamp: new Date().toISOString(),
      }),
    }).catch(console.error)
  }
}

export const experimentManager = new ExperimentManager()

// React Hook 用於實驗
export const useExperiment = (experimentId: string) => {
  const [variant, setVariant] = useState<'control' | 'treatment' | null>(null)
  
  useEffect(() => {
    setVariant(experimentManager.getVariant(experimentId))
  }, [experimentId])
  
  const trackConversion = useCallback((event: string) => {
    experimentManager.trackConversion(experimentId, event)
  }, [experimentId])
  
  return { variant, trackConversion }
}

// 使用範例
export const JobApplicationButton: React.FC = () => {
  const { variant, trackConversion } = useExperiment('job_button_color')
  
  const buttonClass = variant === 'treatment' 
    ? 'bg-green-600 hover:bg-green-700' // 測試綠色按鈕
    : 'bg-blue-600 hover:bg-blue-700'   // 控制組藍色按鈕
  
  const handleClick = () => {
    trackConversion('button_click')
    // 處理按鈕點擊邏輯
  }
  
  return (
    <button 
      className={`px-4 py-2 text-white rounded-md ${buttonClass}`}
      onClick={handleClick}
    >
      新增求職申請
    </button>
  )
}
```

### 📈 用戶回饋收集系統
```typescript
// components/feedback/FeedbackWidget.tsx
interface FeedbackData {
  type: 'bug' | 'feature' | 'improvement' | 'other'
  message: string
  rating?: number
  page: string
  userAgent: string
  timestamp: Date
}

export const FeedbackWidget: React.FC = () => {
  const [isOpen, setIsOpen] = useState(false)
  const [feedbackType, setFeedbackType] = useState<FeedbackData['type']>('improvement')
  const [message, setMessage] = useState('')
  const [rating, setRating] = useState<number>()
  const [isSubmitting, setIsSubmitting] = useState(false)

  const submitFeedback = async () => {
    if (!message.trim()) return

    setIsSubmitting(true)
    try {
      await fetch('/api/feedback', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          type: feedbackType,
          message: message.trim(),
          rating,
          page: window.location.pathname,
          userAgent: navigator.userAgent,
          timestamp: new Date(),
        }),
      })

      // 顯示成功訊息
      toast.success('感謝您的回饋！我們會仔細考慮您的建議。')
      
      // 重置表單
      setMessage('')
      setRating(undefined)
      setIsOpen(false)
    } catch (error) {
      toast.error('提交回饋時發生錯誤，請稍後再試。')
    } finally {
      setIsSubmitting(false)
    }
  }

  return (
    <AnimatePresence>
      {/* 浮動回饋按鈕 */}
      <motion.button
        className="fixed bottom-4 right-4 bg-primary-600 text-white p-3 rounded-full shadow-lg hover:bg-primary-700 z-50"
        onClick={() => setIsOpen(true)}
        whileHover={{ scale: 1.05 }}
        whileTap={{ scale: 0.95 }}
        aria-label="提供回饋"
      >
        <ChatBubbleLeftIcon className="h-6 w-6" />
      </motion.button>

      {/* 回饋對話框 */}
      {isOpen && (
        <motion.div
          className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          exit={{ opacity: 0 }}
          onClick={() => setIsOpen(false)}
        >
          <motion.div
            className="bg-white rounded-lg p-6 w-full max-w-md"
            initial={{ scale: 0.9, opacity: 0 }}
            animate={{ scale: 1, opacity: 1 }}
            exit={{ scale: 0.9, opacity: 0 }}
            onClick={(e) => e.stopPropagation()}
          >
            <h3 className="text-lg font-semibold mb-4">我們想聽聽您的想法</h3>
            
            {/* 回饋類型選擇 */}
            <div className="mb-4">
              <label className="block text-sm font-medium mb-2">回饋類型</label>
              <select
                value={feedbackType}
                onChange={(e) => setFeedbackType(e.target.value as FeedbackData['type'])}
                className="w-full p-2 border rounded-md"
              >
                <option value="improvement">改進建議</option>
                <option value="feature">功能請求</option>
                <option value="bug">錯誤回報</option>
                <option value="other">其他</option>
              </select>
            </div>

            {/* 滿意度評分 */}
            <div className="mb-4">
              <label className="block text-sm font-medium mb-2">
                您對 WorkSync 的整體滿意度如何？
              </label>
              <div className="flex space-x-1">
                {[1, 2, 3, 4, 5].map((star) => (
                  <button
                    key={star}
                    onClick={() => setRating(star)}
                    className={`p-1 ${rating && rating >= star ? 'text-yellow-400' : 'text-gray-300'}`}
                  >
                    <StarIcon className="h-6 w-6 fill-current" />
                  </button>
                ))}
              </div>
            </div>

            {/* 訊息輸入 */}
            <div className="mb-4">
              <label className="block text-sm font-medium mb-2">詳細說明</label>
              <textarea
                value={message}
                onChange={(e) => setMessage(e.target.value)}
                placeholder="請描述您的想法、遇到的問題或建議..."
                className="w-full p-3 border rounded-md h-24 resize-none"
                maxLength={500}
              />
              <div className="text-xs text-gray-500 mt-1">
                {message.length}/500 字元
              </div>
            </div>

            {/* 按鈕 */}
            <div className="flex space-x-3">
              <Button
                variant="outline"
                onClick={() => setIsOpen(false)}
                className="flex-1"
              >
                取消
              </Button>
              <Button
                onClick={submitFeedback}
                loading={isSubmitting}
                disabled={!message.trim()}
                className="flex-1"
              >
                提交回饋
              </Button>
            </div>
          </motion.div>
        </motion.div>
      )}
    </AnimatePresence>
  )
}
```

---

## 🚀 部署與維運指南

### 🌍 環境配置管理
```typescript
// lib/config.ts
interface Config {
  app: {
    name: string
    version: string
    env: 'development' | 'staging' | 'production'
    url: string
  }
  database: {
    url: string
    maxConnections: number
  }
  auth: {
    supabaseUrl: string
    supabaseAnonKey: string
    jwtSecret: string
  }
  apis: {
    github: {
      token?: string
      baseUrl: string
    }
    leetcode: {
      baseUrl: string
    }
  }
  monitoring: {
    sentryDsn?: string
    logLevel: 'debug' | 'info' | 'warn' | 'error'
  }
  features: {
    enableAnalytics: boolean
    enableFeedback: boolean
    enableExperiments: boolean
  }
}

const createConfig = (): Config => {
  // 驗證必要的環境變數
  const requiredEnvVars = [
    'NEXT_PUBLIC_SUPABASE_URL',
    'NEXT_PUBLIC_SUPABASE_ANON_KEY',
    'DATABASE_URL',
  ]

  for (const envVar of requiredEnvVars) {
    if (!process.env[envVar]) {
      throw new Error(`Missing required environment variable: ${envVar}`)
    }
  }

  return {
    app: {
      name: 'WorkSync',
      version: process.env.npm_package_version || '1.0.0',
      env: (process.env.NODE_ENV as Config['app']['env']) || 'development',
      url: process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000',
    },
    database: {
      url: process.env.DATABASE_URL!,
      maxConnections: parseInt(process.env.DB_MAX_CONNECTIONS || '10'),
    },
    auth: {
      supabaseUrl: process.env.NEXT_PUBLIC_SUPABASE_URL!,
      supabaseAnonKey: process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
      jwtSecret: process.env.JWT_SECRET || 'fallback-secret-for-dev',
    },
    apis: {
      github: {
        token: process.env.GITHUB_TOKEN,
        baseUrl: 'https://api.github.com',
      },
      leetcode: {
        baseUrl: 'https://leetcode.com/graphql',
      },
    },
    monitoring: {
      sentryDsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
      logLevel: (process.env.LOG_LEVEL as Config['monitoring']['logLevel']) || 'info',
    },
    features: {
      enableAnalytics: process.env.ENABLE_ANALYTICS === 'true',
      enableFeedback: process.env.ENABLE_FEEDBACK !== 'false', // 預設啟用
      enableExperiments: process.env.ENABLE_EXPERIMENTS === 'true',
    },
  }
}

export const config = createConfig()

// 開發環境驗證
if (config.app.env === 'development') {
  console.log('🔧 Development Configuration:')
  console.log('  App URL:', config.app.url)
  console.log('  Features:', config.features)
  console.log('  Log Level:', config.monitoring.logLevel)
}
```

### 📦 Docker 容器化
```dockerfile
# Dockerfile
FROM node:18-alpine AS base

# 安裝依賴階段
FROM base AS deps
RUN apk add --no-cache libc6-compat
WORKDIR /app

# 複製 package files
COPY package.json package-lock.json* ./
RUN npm ci --only=production

# 建置階段
FROM base AS builder
WORKDIR /app
COPY --from=deps /app/node_modules ./node_modules
COPY . .

# 生成 Prisma client
RUN npx prisma generate

# 建置應用程式
RUN npm run build

# 運行階段
FROM base AS runner
WORKDIR /app

ENV NODE_ENV production

# 創建非 root 用戶
RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

# 複製必要文件
COPY --from=builder /app/public ./public
COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./
COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static

USER nextjs

EXPOSE 3000

ENV PORT 3000
ENV HOSTNAME "0.0.0.0"

CMD ["node", "server.js"]
```

```yaml
# docker-compose.yml
version: '3.8'

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - DATABASE_URL=${DATABASE_URL}
      - NEXT_PUBLIC_SUPABASE_URL=${SUPABASE_URL}
      - NEXT_PUBLIC_SUPABASE_ANON_KEY=${SUPABASE_ANON_KEY}
    depends_on:
      - redis
    restart: unless-stopped

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    command: redis-server --appendonly yes
    volumes:
      - redis_data:/data
    restart: unless-stopped

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./ssl:/etc/nginx/ssl
    depends_on:
      - app
    restart: unless-stopped

volumes:
  redis_data:
```

### 🔄 健康檢查與監控
```typescript
// app/api/health/route.ts
import { NextResponse } from 'next/server'
import { createClient } from '@supabase/supabase-js'
import { config } from '@/lib/config'

interface HealthCheck {
  status: 'healthy' | 'degraded' | 'unhealthy'
  timestamp: string
  version: string
  uptime: number
  checks: {
    database: HealthStatus
    external_apis: HealthStatus
    memory: HealthStatus
  }
}

interface HealthStatus {
  status: 'up' | 'down' | 'degraded'
  responseTime?: number
  error?: string
}

export async function GET() {
  const startTime = Date.now()
  const checks: HealthCheck['checks'] = {
    database: await checkDatabase(),
    external_apis: await checkExternalAPIs(),
    memory: checkMemoryUsage(),
  }

  const overallStatus = determineOverallStatus(checks)
  
  const health: HealthCheck = {
    status: overallStatus,
    timestamp: new Date().toISOString(),
    version: config.app.version,
    uptime: process.uptime(),
    checks,
  }

  const statusCode = overallStatus === 'healthy' ? 200 : 
                    overallStatus === 'degraded' ? 200 : 503

  return NextResponse.json(health, { status: statusCode })
}

async function checkDatabase(): Promise<HealthStatus> {
  try {
    const startTime = Date.now()
    const supabase = createClient(
      config.auth.supabaseUrl,
      config.auth.supabaseAnonKey
    )
    
    await supabase.from('profiles').select('count').limit(1)
    
    return {
      status: 'up',
      responseTime: Date.now() - startTime,
    }
  } catch (error) {
    return {
      status: 'down',
      error: error instanceof Error ? error.message : 'Unknown error',
    }
  }
}

async function checkExternalAPIs(): Promise<HealthStatus> {
  try {
    const startTime = Date.now()
    
    // 檢查 GitHub API
    const response = await fetch('https://api.github.com/rate_limit', {
      headers: config.apis.github.token ? {
        'Authorization': `token ${config.apis.github.token}`,
      } : {},
    })

    if (!response.ok) {
      return {
        status: 'degraded',
        error: `GitHub API returned ${response.status}`,
      }
    }

    return {
      status: 'up',
      responseTime: Date.now() - startTime,
    }
  } catch (error) {
    return {
      status: 'down',
      error: error instanceof Error ? error.message : 'Unknown error',
    }
  }
}

function checkMemoryUsage(): HealthStatus {
  const memUsage = process.memoryUsage()
  const usedMB = memUsage.heapUsed / 1024 / 1024
  const totalMB = memUsage.heapTotal / 1024 / 1024
  const usagePercent = (usedMB / totalMB) * 100

  if (usagePercent > 90) {
    return {
      status: 'degraded',
      error: `High memory usage: ${usagePercent.toFixed(1)}%`,
    }
  }

  return {
    status: 'up',
    responseTime: usagePercent,
  }
}

function determineOverallStatus(
  checks: HealthCheck['checks']
): HealthCheck['status'] {
  const statuses = Object.values(checks).map(check => check.status)
  
  if (statuses.includes('down')) return 'unhealthy'
  if (statuses.includes('degraded')) return 'degraded'
  return 'healthy'
}
```

---

## 📚 最終檢查清單

### ✅ 開發完成檢查清單

#### 🔧 技術實作
- [ ] **Next.js 14 App Router** 正確設定
- [ ] **TypeScript 嚴格模式** 無錯誤
- [ ] **Supabase + Prisma** 資料庫整合完成
- [ ] **shadcn/ui + Tailwind** UI 系統建立
- [ ] **Zustand + React Query** 狀態管理實作
- [ ] **Framer Motion** 動畫效果整合
- [ ] **Chart.js** 資料視覺化完成

#### 🎯 核心功能
- [ ] **求職追蹤系統** CRUD 功能完整
- [ ] **番茄鐘計時器** 時間管理功能
- [ ] **學習進度追蹤** GitHub/LeetCode 整合
- [ ] **情緒追蹤系統** 心情記錄與分析
- [ ] **數據視覺化** 統計圖表展示
- [ ] **響應式設計** 跨裝置完美支援

#### 🔒 安全性
- [ ] **輸入驗證** Zod schema 驗證
- [ ] **XSS 防護** DOMPurify 清理
- [ ] **CSRF 防護** Token 驗證
- [ ] **SQL 注入防護** Prisma ORM 使用
- [ ] **RLS 安全** Supabase 行級安全
- [ ] **環境變數** 敏感資訊保護

#### 🚀 效能最佳化
- [ ] **代碼分割** React.lazy 實作
- [ ] **圖片最佳化** Next.js Image 組件
- [ ] **快取策略** React Query 快取
- [ ] **Bundle 大小** < 500KB (gzipped)
- [ ] **Core Web Vitals** 指標達標
- [ ] **PWA 功能** 離線支援

#### 🧪 測試覆蓋
- [ ] **單元測試** 關鍵組件覆蓋 >80%
- [ ] **整合測試** API 路由測試
- [ ] **E2E 測試** 主要用戶流程
- [ ] **可訪問性** WCAG 2.1 AA 標準
- [ ] **跨瀏覽器** Chrome/Firefox/Safari 測試

#### 📱 用戶體驗
- [ ] **載入狀態** 所有非同步操作
- [ ] **錯誤處理** 友善錯誤訊息
- [ ] **空狀態** 引導性設計
- [ ] **反饋機制** 成功/失敗通知
- [ ] **幽默元素** 反諷文案設計
- [ ] **無障礙** 鍵盤導航支援

### 📋 部署前檢查

#### 🌐 環境設定
- [ ] **生產環境變數** 正確配置
- [ ] **資料庫遷移** 生產環境同步
- [ ] **SSL 憑證** HTTPS 設定
- [ ] **CDN 配置** 靜態資源最佳化
- [ ] **監控設定** Sentry 錯誤追蹤
- [ ] **備份策略** 資料庫定期備份

#### 📊 監控與分析
- [ ] **健康檢查** API 端點實作
- [ ] **效能監控** Core Web Vitals 追蹤
- [ ] **錯誤追蹤** Sentry 整合
- [ ] **用戶分析** 關鍵事件追蹤
- [ ] **A/B 測試** 實驗框架設定
- [ ] **回饋收集** 用戶意見機制

#### 📚 文檔完整性
- [ ] **README** 安裝與使用說明
- [ ] **API 文檔** 端點說明與範例
- [ ] **部署指南** 環境設定說明
- [ ] **故障排除** 常見問題解決
- [ ] **貢獻指南** 開發流程說明
- [ ] **變更日誌** 版本更新記錄

---

## 🎯 總結與下一步

### 🏆 專案價值主張
WorkSync 不僅是一個技術展示專案，更是一個具有實際價值的求職工具：

1. **技術深度展示**：涵蓋前端、後端、資料庫、API 整合等全棧技能
2. **產品思維體現**：解決真實用戶痛點，具有市場價值
3. **設計美學**：現代化 UI/UX，注重用戶體驗
4. **創新元素**：反諷幽默設計，情感化用戶體驗
5. **可擴展性**：模組化架構，易於功能擴展

### 🚀 技能等級評估
基於此技術規格文件實作的專案，能夠展示的技能水準：

- **前端開發**：資深級別 (90萬+ 年薪匹配)
- **系統設計**：中高級別
- **產品思維**：高級別
- **代碼品質**：資深級別
- **用戶體驗**：高級別

### 📈 後續發展方向
1. **功能擴展**：AI 智能建議、社群功能、移動應用
2. **商業化**：SaaS 服務、企業版本、付費功能
3. **開源貢獻**：開源社群建設、技術分享
4. **技術演進**：新技術整合、架構升級

### 💡 AI 協作建議
使用此技術文檔與 AI 協作時：

1. **明確引用**：直接引用相關章節進行開發
2. **遵循規範**：嚴格按照安全性和代碼品質要求
3. **保持一致**：維持設計系統和命名規範的一致性
4. **逐步實作**：按照功能優先級分階段開發
5. **持續優化**：定期回顧和更新技術規格


## **核心功能架構優化建議**

### **🎯 必做核心功能（技術展示重點）**

#### **1. 求職追蹤 Dashboard**

- **求職數據視覺化**：投遞數、回覆率、面試邀請率的即時圖表
- **面試提醒系統**：倒數計時、日曆整合、桌面通知
- **情緒追蹤**：每日求職心情指數（1-10）與趨勢分析
- **反諷元素**：「今日被拒絕次數」、「距離下次被打槍還有 X 天」

#### **2. 學習進度可視化**

- **LeetCode API 整合**：自動同步解題數量、難度分布
- **GitHub API 整合**：commit 頻率、專案進度
- **技能雷達圖**：React、TypeScript、Next.js 等技能自評進度
- **學習時間統計**：番茄鐘記錄的學習時數分析

#### **3. 番茄鐘時間管理**

- **智能時間分配**：自動建議「找工作 vs 自學」的黃金比例
- **焦慮緩解模式**：特殊的「喘息番茄」（短休息模式）
- **成就系統**：「連續學習 X 天」、「本週投履歷 X 份」徽章

#### **4. 數據洞察分析**

- **求職效率分析**：哪種類型職缺回覆率最高
- **學習投資報酬率**：學習時數 vs 面試邀請的相關性
- **焦慮指數預測**：根據歷史數據預測低潮期

---

## 🎨 **UI/UX 設計方向（2025現代感）**

### **設計風格建議**：

- **Glassmorphism**：毛玻璃效果卡片
- **Dark Mode 優先**：符合開發者習慣
- **微交互動畫**：Framer Motion 或 GSAP
- **數據美學**：Chart.js + 自定義 CSS 動畫

### **反諷幽默元素**：

- **Loading 文案**：「正在計算被拒絕的機率...」
- **空狀態設計**：「恭喜！今天還沒被拒絕」
- **成就解鎖**：「解鎖成就：一週內被拒絕 5 次」

---

## 🔧 **技術棧建議（90萬薪資匹配）**

### **前端核心**：

- **Next.js 14** (App Router)
- **TypeScript** (嚴格模式)
- **Tailwind CSS + shadcn/ui**
- **Framer Motion** (動畫)

### **狀態管理**：

- **Zustand** (輕量但專業)
- **React Query / TanStack Query** (數據獲取)

### **資料庫**：

- **Supabase** (比 Firebase 更現代，展示 SQL 技能)
- **Prisma ORM** (type-safe 資料庫操作)

### **API 整合**：

- **LeetCode API** (非官方，展示 API 整合能力)
- **GitHub GraphQL API** (展示 GraphQL 技能)
- **Google Calendar API** (面試提醒)

### **部署與監控**：

- **Vercel** (前端部署)
- **Upstash Redis** (快取層)
- **Sentry** (錯誤監控)

---

## 📈 **難度調整建議**

### **🟢 保留簡單（但精緻）**：

- 基本的 CRUD 操作
- 圖表展示功能
- 響應式設計

### **🟡 中等難度展示**：

- 多 API 整合與錯誤處理
- 複雜狀態管理
- 動畫系統設計
- PWA 功能（桌面通知）

### **🔴 高難度加分項**：

- **即時數據同步**：WebSocket 或 Server-Sent Events
- **機器學習預測**：簡單的焦慮指數預測算法
- **自動化測試**：Playwright E2E 測試

---

## 🚫 **建議移除或簡化**：

### **AI 助手功能**：

- **理由**：API 成本高、與核心功能關聯性低
- **替代**：改為「智能建議系統」（基於規則的邏輯）

### **過度複雜的分析**：

- 保持數據分析簡單明瞭，重點在視覺化呈現

---

## 🎯 **展示重點順序**

### **技術深度展示**：

1. **TypeScript 嚴格類型**：展示 type-safe 開發
2. **API 整合架構**：多數據源整合能力
3. **狀態管理**：複雜狀態的優雅處理
4. **動畫系統**：流暢的 UI 動效
5. **效能優化**：bundle 大小、載入速度優化

### **產品思維展示**：

1. **用戶體驗設計**：解決真實痛點
2. **數據驅動決策**：用數據指導功能設計
3. **漸進式增強**：從 MVP 到完整功能

## 📋 **文件內容總覽**

### 🎯 **專案定義部分**

- **核心理念**：具有反諷意味的求職焦慮緩解 Dashboard
- **目標薪資**：展示符合 90萬年薪的技術深度
- **設計哲學**：療癒性設計 + 反諷幽默 + 數據美學

### 🏗️ **技術架構規範**

- **完整技術棧**：Next.js 14、TypeScript、Supabase、Prisma、Zustand
- **安全性要求**：XSS防護、CSRF防護、輸入驗證、RLS安全
- **效能最佳化**：代碼分割、快取策略、PWA功能

### 📊 **功能規格詳述**

- **求職追蹤系統**：完整的資料模型與API設計
- **番茄鐘計時器**：Custom Hook與本地儲存邏輯
- **學習進度追蹤**：GitHub/LeetCode API整合
- **情緒追蹤系統**：心情分析與視覺化

### 🎨 **設計系統**

- **UI組件規範**：Button、Card等基礎組件設計
- **色彩系統**：情感化色彩對應與品牌配色
- **動畫系統**：Framer Motion動效規範
- **幽默元素**：反諷文案與成就系統設計

### 🔒 **安全與品質**

- **代碼品質標準**：ESLint、Prettier、TypeScript嚴格配置
- **測試策略**：單元測試、E2E測試、效能測試
- **部署與監控**：Docker容器化、健康檢查、錯誤追蹤

### 📚 **開發指南**

- **命名規範**：文件、變數、函數的一致性命名
- **Git工作流程**：分支策略與Commit規範
- **故障排除**：常見問題解決方案

---

*此技術規格文檔將持續更新，確保與專案發展同步。每次重大更新都會有版本記錄和變更說明。*

**文檔版本**: 1.0  
**最後更新**: 2025-08-03  
**下次檢核**: 2025-09-03
    #### ESLint 配置
```json
// .eslintrc.json
{
  "extends": [
    "next/core-web-vitals",
    "@typescript-eslint/recommended",
    "prettier"
  ],
  "rules": {
    "@typescript-eslint/no-unused-vars": "error",
    "@typescript-eslint/explicit-function-return-type": "warn",
    "@typescript-eslint/no-explicit-any": "error",
    "react/prop-types": "off",
    "react/react-in-jsx-scope": "off",
    "prefer-const": "error",
    "no-var": "error"
  },
  "parserOptions": {
    "ecmaVersion": "latest",
    "sourceType": "module"
  }
}
```

#### Prettier 配置
```json
// .prettierrc
{
  "semi": false,
  "trailingComma": "es5",
  "singleQuote": true,
  "tabWidth": 2,
  "useTabs": false,
  "printWidth": 80,
  "bracketSpacing": true,
  "arrowParens": "avoid",
  "endOfLine": "lf"
}
```

#### TypeScript 嚴格配置
```json
// tsconfig.json
{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["dom", "dom.iterable", "ES6"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"],
      "@/components/*": ["./src/components/*"],
      "@/lib/*": ["./src/lib/*"],
      "@/hooks/*": ["./src/hooks/*"],
      "@/types/*": ["./src/types/*"]
    },
    // 嚴格型別檢查
    "noImplicitAny": true,
    "noImplicitReturns": true,
    "noImplicitThis": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "exactOptionalPropertyTypes": true
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
```

### 📁 專案結構規範
```
src/
├── app/                    # Next.js App Router
│   ├── (auth)/            # 路由群組：身份驗證相關頁面
│   │   ├── login/
│   │   └── register/
│   ├── dashboard/          # 主要功能頁面
│   │   ├── page.tsx       # Dashboard 首頁
│   │   ├── jobs/          # 求職管理
│   │   ├── learning/      # 學習進度
│   │   ├── pomodoro/      # 番茄鐘
│   │   └── mood/          # 情緒追蹤
│   ├── api/               # API 路由
│   │   ├── auth/
│   │   ├── jobs/
│   │   ├── learning/
│   │   ├── pomodoro/
│   │   └── mood/
│   ├── globals.css
│   ├── layout.tsx
│   └── page.tsx
├── components/             # 可重用組件
│   ├── ui/                # shadcn/ui 基礎組件
│   ├── charts/            # 圖表組件
│   ├── forms/             # 表單組件
│   ├── layouts/           # 佈局組件
│   └── features/          # 功能特定組件
│       ├── job-tracker/
│       ├── pomodoro/
│       ├── learning/
│       └── mood/
├── hooks/                 # 自定義 Hooks
│   ├── usePomodoro.ts
│   ├── useJobStats.ts
│   ├── useLearningStats.ts
│   └── useMood.ts
├── lib/                   # 工具函數與配置
│   ├── supabase.ts
│   ├── prisma.ts
│   ├── utils.ts
│   ├── validations.ts
│   └── constants.ts
├── types/                 # TypeScript 型別定義
│   ├── database.types.ts  # Supabase 生成的型別
│   ├── api.types.ts
│   ├── job.types.ts
│   ├── learning.types.ts
│   └── mood.types.ts
├── stores/                # Zustand store
│   ├── jobStore.ts
│   ├── pomodoroStore.ts
│   ├── learningStore.ts
│   └── moodStore.ts
└── utils/                 # 純工具函數
    ├── formatters.ts
    ├── validators.ts
    ├── date.ts
    └── api.ts
```

### 🎯 命名規範

#### 文件命名
```typescript
// 組件文件：PascalCase
JobApplicationCard.tsx
PomodoroTimer.tsx
LearningProgressChart.tsx

// Hook 文件：camelCase，以 use 開頭
useJobStats.ts
usePomodoro.ts
useLearningData.ts

// 工具函數：camelCase
formatDate.ts
validateEmail.ts
calculateStats.ts

// 常數文件：camelCase
jobConstants.ts
apiConstants.ts
```

#### 變數與函數命名
```typescript
// 變數：camelCase，描述性命名
const jobApplicationData = []
const isLoading = false
const userMoodHistory = []

// 函數：camelCase，動詞開頭
const fetchJobApplications = async () => {}
const calculateMoodAverage = (data: MoodEntry[]) => {}
const validateJobForm = (data: JobFormData) => {}

// 常數：SCREAMING_SNAKE_CASE
const MAX_RETRIES = 3
const API_BASE_URL = 'https://api.example.com'
const POMODORO_WORK_DURATION = 25 * 60 // 秒
```

#### 組件與 Props 命名
```typescript
// 組件 Props：Interface 以 Props 結尾
interface JobCardProps {
  job: JobApplication
  onEdit: (id: string) => void
  onDelete: (id: string) => void
  className?: string
}

// State Interface：描述性命名
interface PomodoroState {
  isRunning: boolean
  timeLeft: number
  currentSession: number
  phase: PomodoroPhase
}

// Event Handler：on + 動作
const handleSubmit = () => {}
const handleCancel = () => {}
const handleJobDelete = (id: string) => {}
```

---

## 🔍 API 設計詳細規範

### 🌐 REST API 標準

#### 統一回應格式
```typescript
// 成功回應格式
interface ApiResponse<T> {
  success: true
  data: T
  message?: string
  pagination?: {
    page: number
    limit: number
    total: number
    totalPages: number
  }
}

// 錯誤回應格式
interface ApiErrorResponse {
  success: false
  error: {
    code: string
    message: string
    details?: Record<string, any>
  }
  timestamp: string
  path: string
}

// API 回應輔助函數
export const createApiResponse = <T>(
  data: T, 
  message?: string
): ApiResponse<T> => ({
  success: true,
  data,
  message,
})

export const createApiError = (
  code: string,
  message: string,
  details?: Record<string, any>
): ApiErrorResponse => ({
  success: false,
  error: { code, message, details },
  timestamp: new Date().toISOString(),
  path: '', // 在 API handler 中填入
})
```

#### HTTP 狀態碼使用標準
```typescript
// 狀態碼對應表
const HTTP_STATUS = {
  OK: 200,                    // 成功 GET, PUT
  CREATED: 201,               // 成功 POST
  NO_CONTENT: 204,            // 成功 DELETE
  BAD_REQUEST: 400,           // 請求格式錯誤
  UNAUTHORIZED: 401,          // 未授權
  FORBIDDEN: 403,             // 禁止存取
  NOT_FOUND: 404,             // 資源不存在
  CONFLICT: 409,              // 資源衝突
  UNPROCESSABLE_ENTITY: 422,  // 驗證失敗
  INTERNAL_SERVER_ERROR: 500, // 伺服器錯誤
} as const

// 使用範例
export async function POST(request: Request) {
  try {
    const body = await request.json()
    const validatedData = JobApplicationSchema.parse(body)
    
    const newJob = await createJobApplication(validatedData)
    
    return NextResponse.json(
      createApiResponse(newJob, 'Job application created successfully'),
      { status: HTTP_STATUS.CREATED }
    )
  } catch (error) {
    if (error instanceof z.ZodError) {
      return NextResponse.json(
        createApiError('VALIDATION_ERROR', 'Invalid input data', error.errors),
        { status: HTTP_STATUS.UNPROCESSABLE_ENTITY }
      )
    }
    
    return NextResponse.json(
      createApiError('INTERNAL_ERROR', 'Something went wrong'),
      { status: HTTP_STATUS.INTERNAL_SERVER_ERROR }
    )
  }
}
```

### 🔐 身份驗證中介軟體
```typescript
// 身份驗證裝飾器
import { createRouteHandlerClient } from '@supabase/auth-helpers-nextjs'
import { cookies } from 'next/headers'

export const withAuth = (
  handler: (request: Request, context: { params: any }) => Promise<Response>
) => {
  return async (request: Request, context: { params: any }) => {
    try {
      const supabase = createRouteHandlerClient({ cookies })
      
      const { data: { user }, error } = await supabase.auth.getUser()
      
      if (error || !user) {
        return NextResponse.json(
          createApiError('UNAUTHORIZED', 'Authentication required'),
          { status: HTTP_STATUS.UNAUTHORIZED }
        )
      }
      
      // 將用戶資訊注入到 request 中
      const requestWithUser = new Request(request.url, {
        ...request,
        headers: {
          ...request.headers,
          'x-user-id': user.id,
        },
      })
      
      return handler(requestWithUser, context)
    } catch (error) {
      return NextResponse.json(
        createApiError('INTERNAL_ERROR', 'Authentication error'),
        { status: HTTP_STATUS.INTERNAL_SERVER_ERROR }
      )
    }
  }
}

// 使用範例
export const GET = withAuth(async (request: Request) => {
  const userId = request.headers.get('x-user-id')!
  const jobs = await getJobApplicationsByUserId(userId)
  return NextResponse.json(createApiResponse(jobs))
})
```

### 📊 分頁處理
```typescript
// 分頁參數驗證
const PaginationSchema = z.object({
  page: z.coerce.number().min(1).default(1),
  limit: z.coerce.number().min(1).max(50).default(10),
  sort: z.enum(['appliedAt', 'company', 'position']).default('appliedAt'),
  order: z.enum(['asc', 'desc']).default('desc'),
})

// 分頁查詢函數
export const paginateQuery = async <T>(
  queryFn: (skip: number, take: number) => Promise<T[]>,
  countFn: () => Promise<number>,
  pagination: z.infer<typeof PaginationSchema>
): Promise<{
  data: T[]
  pagination: {
    page: number
    limit: number
    total: number
    totalPages: number
  }
}> => {
  const { page, limit } = pagination
  const skip = (page - 1) * limit
  
  const [data, total] = await Promise.all([
    queryFn(skip, limit),
    countFn(),
  ])
  
  return {
    data,
    pagination: {
      page,
      limit,
      total,
      totalPages: Math.ceil(total / limit),
    },
  }
}
```

---

## 🎨 設計系統與組件規範

### 🧩 基礎組件設計

#### Button 組件
```typescript
// Button 組件設計
import { cva, type VariantProps } from 'class-variance-authority'
import { cn } from '@/lib/utils'

const buttonVariants = cva(
  // base styles
  "inline-flex items-center justify-center rounded-md text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",
  {
    variants: {
      variant: {
        default: "bg-primary-600 text-white hover:bg-primary-700 active:bg-primary-800",
        destructive: "bg-red-600 text-white hover:bg-red-700 active:bg-red-800",
        outline: "border border-gray-300 bg-transparent hover:bg-gray-50 active:bg-gray-100",
        secondary: "bg-gray-100 text-gray-900 hover:bg-gray-200 active:bg-gray-300",
        ghost: "hover:bg-gray-100 active:bg-gray-200",
        link: "text-primary-600 underline-offset-4 hover:underline",
      },
      size: {
        default: "h-10 px-4 py-2",
        sm: "h-9 rounded-md px-3",
        lg: "h-11 rounded-md px-8",
        icon: "h-10 w-10",
      },
      loading: {
        true: "cursor-not-allowed",
        false: "",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
      loading: false,
    },
  }
)

interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  loading?: boolean
  leftIcon?: React.ReactNode
  rightIcon?: React.ReactNode
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, loading, leftIcon, rightIcon, children, ...props }, ref) => {
    return (
      <button
        className={cn(buttonVariants({ variant, size, loading, className }))}
        ref={ref}
        disabled={loading || props.disabled}
        {...props}
      >
        {loading && (
          <svg className="mr-2 h-4 w-4 animate-spin" viewBox="0 0 24 24">
            <circle
              className="opacity-25"
              cx="12"
              cy="12"
              r="10"
              stroke="currentColor"
              strokeWidth="4"
              fill="none"
            />
            <path
              className="opacity-75"
              fill="currentColor"
              d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
            />
          </svg>
        )}
        {!loading && leftIcon && <span className="mr-2">{leftIcon}</span>}
        {children}
        {!loading && rightIcon && <span className="ml-2">{rightIcon}</span>}
      </button>
    )
  }
)

Button.displayName = "Button"
export { Button, buttonVariants }
```

#### Card 組件
```typescript
// Card 組件設計
interface CardProps extends React.HTMLAttributes<HTMLDivElement> {
  hover?: boolean
  padding?: 'none' | 'sm' | 'md' | 'lg'
}

const Card = React.forwardRef<HTMLDivElement, CardProps>(
  ({ className, hover = false, padding = 'md', children, ...props }, ref) => {
    const paddingClasses = {
      none: '',
      sm: 'p-4',
      md: 'p-6',
      lg: 'p-8',
    }

    return (
      <motion.div
        ref={ref}
        className={cn(
          "rounded-lg border bg-white shadow-sm",
          paddingClasses[padding],
          hover && "transition-all duration-200 hover:shadow-md hover:-translate-y-1",
          className
        )}
        whileHover={hover ? { y: -2, boxShadow: "0 10px 25px -5px rgba(0, 0, 0, 0.1)" } : undefined}
        {...props}
      >
        {children}
      </motion.div>
    )
  }
)

Card.displayName = "Card"

// Card 子組件
const CardHeader = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn("flex flex-col space-y-1.5 pb-6", className)} {...props} />
  )
)

const CardTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(
  ({ className, ...props }, ref) => (
    <h3 ref={ref} className={cn("text-2xl font-semibold leading-none tracking-tight", className)} {...props} />
  )
)

const CardDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(
  ({ className, ...props }, ref) => (
    <p ref={ref} className={cn("text-sm text-gray-600", className)} {...props} />
  )
)

const CardContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn("pt-0", className)} {...props} />
  )
)

const CardFooter = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn("flex items-center pt-6", className)} {...props} />
  )
)

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }
```

### 📊 圖表組件規範
```typescript
// 統一圖表配置
export const chartTheme = {
  colors: {
    primary: '#14b8a6',
    secondary: '#f97316',
    success: '#10b981',
    warning: '#f59e0b',
    danger: '#ef4444',
    gray: '#6b7280',
  },
  
  defaultOptions: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        position: 'top' as const,
        labels: {
          usePointStyle: true,
          padding: 20,
          font: {
            family: 'Inter, sans-serif',
            size: 12,
          },
        },
      },
      tooltip: {
        backgroundColor: 'rgba(0, 0, 0, 0.8)',
        titleColor: 'white',
        bodyColor: 'white',
        borderColor: 'rgba(255, 255, 255, 0.1)',
        borderWidth: 1,
        cornerRadius: 8,
        padding: 12,
      },
    },
    scales: {
      x: {
        grid: {
          display: false,
        },
        ticks: {
          font: {
            family: 'Inter, sans-serif',
            size: 11,
          },
        },
      },
      y: {
        grid: {
          color: 'rgba(0, 0, 0, 0.05)',
        },
        ticks: {
          font: {
            family: 'Inter, sans-serif',
            size: 11,
          },
        },
      },
    },
  },
}

// 求職統計圖表組件
interface JobStatsChartProps {
  data: JobApplicationStats
  type: 'line' | 'bar' | 'doughnut'
  className?: string
}

export const JobStatsChart: React.FC<JobStatsChartProps> = ({ 
  data, 
  type, 
  className 
}) => {
  const chartData = useMemo(() => {
    switch (type) {
      case 'line':
        return {
          labels: data.timeline.map(item => format(new Date(item.date), 'MMM dd')),
          datasets: [
            {
              label: '累計投遞',
              data: data.timeline.map(item => item.totalApplications),
              borderColor: chartTheme.colors.primary,
              backgroundColor: `${chartTheme.colors.primary}20`,
              tension: 0.4,
            },
            {
              label: '面試邀請',
              data: data.timeline.map(item => item.interviews),
              borderColor: chartTheme.colors.secondary,
              backgroundColor: `${chartTheme.colors.secondary}20`,
              tension: 0.4,
            },
          ],
        }
      
      case 'doughnut':
        return {
          labels: ['已投遞', '面試中', '已拒絕', '已錄取'],
          datasets: [
            {
              data: [
                data.summary.applied,
                data.summary.interview,
                data.summary.rejected,
                data.summary.offer,
              ],
              backgroundColor: [
                chartTheme.colors.primary,
                chartTheme.colors.warning,
                chartTheme.colors.danger,
                chartTheme.colors.success,
              ],
            },
          ],
        }
      
      default:
        return { labels: [], datasets: [] }
    }
  }, [data, type])

  const options = {
    ...chartTheme.defaultOptions,
    plugins: {
      ...chartTheme.defaultOptions.plugins,
      legend: {
        ...chartTheme.defaultOptions.plugins.legend,
        display: type !== 'doughnut',
      },
    },
  }

  return (
    <div className={cn("relative h-64 w-full", className)}>
      {type === 'line' && <Line data={chartData} options={options} />}
      {type === 'bar' && <Bar data={chartData} options={options} />}
      {type === 'doughnut' && <Doughnut data={chartData} options={options} />}
    </div>
  )
}
```

---

## 🔧 開發工具與工作流程

### 🛠️ 開發腳本
```json
// package.json scripts
{
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "lint:fix": "next lint --fix",
    "type-check": "tsc --noEmit",
    "format": "prettier --write .",
    "format:check": "prettier --check .",
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage",
    "e2e": "playwright test",
    "e2e:ui": "playwright test --ui",
    "db:push": "prisma db push",
    "db:generate": "prisma generate",
    "db:studio": "prisma studio",
    "db:seed": "tsx prisma/seed.ts",
    "analyze": "cross-env ANALYZE=true next build",
    "postinstall": "prisma generate"
  }
}
```

### 🐙 Git 工作流程
```bash
# 分支命名規範
feature/job-tracker-crud     # 新功能
fix/pomodoro-timer-bug      # 錯誤修復
refactor/api-structure      # 重構
docs/update-readme          # 文件更新
chore/update-dependencies   # 維護任務

# Commit 訊息規範（Conventional Commits）
feat: add job application CRUD functionality
fix: resolve pomodoro timer countdown issue
refactor: restructure API response format
docs: update installation instructions
style: fix code formatting
test: add unit tests for job statistics
chore: update dependencies to latest versions

# 例子
git commit -m "feat(job-tracker): add job application filtering and sorting

- Add status filter dropdown
- Implement date range filtering
- Add sorting by company and application date
- Update API to support query parameters

Closes #123"
```

### 🔄 CI/CD 配置
```yaml
# .github/workflows/ci.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Type check
        run: npm run type-check
      
      - name: Lint
        run: npm run lint
      
      - name: Format check
        run: npm run format:check
      
      - name: Run tests
        run: npm run test:coverage
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3
        with:
          file: ./coverage/lcov.info

  e2e:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Install Playwright browsers
        run: npx playwright install --with-deps
      
      - name: Run E2E tests
        run: npm run e2e

  deploy:
    needs: [test, e2e]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
      - name: Deploy to Vercel
        uses: vercel/action@v1
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
```

---

## 📚 文檔與維護

### 📖 README 結構
```markdown
# WorkSync - 求職焦慮緩解 Dashboard

> 一個具有反諷意味的求職管理工具，用數據和幽默來對抗求職焦慮

## ✨ 功能特色

- 📊 **求職追蹤**：視覺化管理求職進度
- ⏰ **番茄鐘計時器**：優化學習與求職時間分配
- 📈 **學習進度追蹤**：整合 GitHub 和 LeetCode 數據
- 😊 **情緒追蹤**：記錄和分析求職心情變化
- 🎨 **現代化 UI**：Glassmorphism 設計風格
- 📱 **響應式設計**：完美支援各種設備

## 🚀 快速開始

### 環境需求
- Node.js 18+
- npm 或 yarn
- PostgreSQL（或 Supabase）

### 安裝步驟
1. 克隆專案
   ```bash
   git clone https://github.com/username/worksync.git
   cd worksync
   ```

2. 安裝依賴
   ```bash
   npm install
   ```

3. 設定環境變數
   ```bash
   cp .env.example .env.local
   # 編輯 .env.local 填入你的配置
   ```

4. 初始化資料庫
   ```bash
   npm run db:push
   npm run db:seed
   ```

5. 啟動開發服務器
   ```bash
   npm run dev
   ```

## 🛠️ 技術棧

- **前端**: Next.js 14, React 18, TypeScript
- **樣式**: Tailwind CSS, shadcn/ui
- **狀態管理**: Zustand, TanStack Query
- **動畫**: Framer Motion
- **資料庫**: Supabase, Prisma ORM
- **圖表**: Chart.js
- **測試**: Jest, Playwright
- **部署**: Vercel

## 📱 功能截圖

[功能截圖待加入]

## 🤝 貢獻指南

請閱讀 [CONTRIBUTING.md](CONTRIBUTING.md) 了解如何貢獻代碼。

## 📄 授權

此專案採用 MIT 授權 - 詳見 [LICENSE](LICENSE) 文件。
```

### 🔍 故障排除指南
```markdown
# 常見問題解決

## 開發環境問題

### Q: 為什麼 `npm run dev` 失敗？
A: 請檢查：
1. Node.js 版本是否為 18+
2. 是否正確設定 `.env.local`
3. 是否執行過 `npm install`

### Q: 資料庫連線失敗
A: 請確認：
1. Supabase URL 和 API Key 正確
2. 網路連線正常
3. 執行 `npm run db:push` 初始化資料庫

### Q: TypeScript 錯誤
A: # WorkSync 技術規格文件
*Version 1.0 - 求職焦慮緩解 Dashboard*

---

## 📋 專案概述

### 🎯 專案核心理念
**WorkSync** 是一個具有反諷意味的求職焦慮緩解 Dashboard，通過數據可視化、時間管理和幽默元素來幫助求職者管理求職過程中的焦慮情緒。

### 🎨 設計哲學
- **療癒性設計**：溫和的色彩搭配，舒緩視覺體驗
- **反諷幽默**：適度的自嘲元素，緩解求職壓力
- **數據美學**：將枯燥的數據轉化為美觀的視覺呈現
- **現代感**：符合 2025 年設計趨勢的 UI/UX

### 🚀 目標薪資水準
展示符合年薪 90 萬新台幣以上職位所需的技術深度與產品思維

---

## 🏗️ 技術架構規範

### 📦 核心技術棧

#### 前端框架
```typescript
// 必須使用 Next.js 14 App Router
"next": "^14.0.0"
"react": "^18.0.0"
"typescript": "^5.0.0"
```

#### 樣式系統
```typescript
// Tailwind CSS + shadcn/ui 組合
"tailwindcss": "^3.4.0"
"@radix-ui/react-*": "latest" // shadcn/ui 基礎
"class-variance-authority": "^0.7.0" // CVA 樣式變體管理
```

#### 狀態管理
```typescript
// Zustand 為主要狀態管理
"zustand": "^4.4.0"
"@tanstack/react-query": "^5.0.0" // 服務端狀態管理
"react-hook-form": "^7.45.0" // 表單狀態
```

#### 動畫系統
```typescript
// Framer Motion 動畫庫
"framer-motion": "^10.0.0"
// 可選：GSAP（用於複雜動畫）
"gsap": "^3.12.0"
```

#### 資料庫與後端
```typescript
// Supabase 作為 Backend as a Service
"@supabase/supabase-js": "^2.38.0"
"@supabase/auth-helpers-nextjs": "^0.8.0"

// Prisma ORM（type-safe 資料庫操作）
"prisma": "^5.6.0"
"@prisma/client": "^5.6.0"
```

#### 圖表與視覺化
```typescript
// Chart.js 生態系統
"chart.js": "^4.4.0"
"react-chartjs-2": "^5.2.0"
"chartjs-adapter-date-fns": "^3.0.0"
```

#### API 整合
```typescript
// 第三方 API 整合
"@octokit/rest": "^20.0.0" // GitHub API
"axios": "^1.6.0" // HTTP 客戶端
"swr": "^2.2.0" // 或作為 React Query 的替代方案
```

---

## 🔒 安全性要求

### 🛡️ 身份驗證與授權

#### Supabase Auth 配置
```typescript
// 必須配置的安全設定
const supabaseConfig = {
  url: process.env.NEXT_PUBLIC_SUPABASE_URL!,
  anonKey: process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
  auth: {
    autoRefreshToken: true,
    persistSession: true,
    detectSessionInUrl: false, // 防止 URL 洩漏
  }
}

// RLS (Row Level Security) 必須啟用
-- 資料庫中每個 table 都必須有 RLS 政策
ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Users can only access their own data" 
ON profiles FOR ALL USING (auth.uid() = user_id);
```

#### 環境變數安全
```bash
# .env.local - 敏感資訊絕不可暴露到前端
SUPABASE_SERVICE_ROLE_KEY=xxx  # 僅後端使用
DATABASE_URL=xxx               # Prisma 連線字串
GITHUB_TOKEN=xxx               # GitHub API 存取權杖

# .env.example - 公開範本，不含實際值
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
```

### 🔐 API 安全規範

#### 輸入驗證
```typescript
// 使用 Zod 進行嚴格的輸入驗證
import { z } from 'zod'

const JobApplicationSchema = z.object({
  company: z.string().min(1).max(100).trim(),
  position: z.string().min(1).max(200).trim(),
  salary: z.number().positive().optional(),
  status: z.enum(['applied', 'interview', 'offer', 'rejected']),
  appliedAt: z.date(),
  notes: z.string().max(1000).optional(),
})

// API 路由中必須驗證
export async function POST(request: Request) {
  try {
    const body = await request.json()
    const validatedData = JobApplicationSchema.parse(body) // 拋出錯誤如果無效
    // 處理邏輯...
  } catch (error) {
    if (error instanceof z.ZodError) {
      return NextResponse.json({ error: error.errors }, { status: 400 })
    }
    return NextResponse.json({ error: 'Internal error' }, { status: 500 })
  }
}
```

#### CSRF 防護
```typescript
// 使用 Next.js CSRF token
import { getCsrfToken } from 'next-auth/react'

// 每個 mutation 請求都包含 CSRF token
const csrfToken = await getCsrfToken()
const response = await fetch('/api/jobs', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-CSRF-Token': csrfToken,
  },
  body: JSON.stringify(data),
})
```

#### 資料清理
```typescript
// 防止 XSS 攻擊的資料清理
import DOMPurify from 'isomorphic-dompurify'

const sanitizeInput = (input: string): string => {
  return DOMPurify.sanitize(input, { 
    ALLOWED_TAGS: [], // 不允許任何 HTML 標籤
    ALLOWED_ATTR: [] 
  })
}

// 在儲存使用者輸入前必須清理
const cleanedNotes = sanitizeInput(userInput.notes)
```

---

## 📊 核心功能規格

### 🎯 求職追蹤系統

#### 資料模型
```typescript
// Prisma Schema
model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  jobApplications JobApplication[]
  learningLogs    LearningLog[]
  pomodoroSessions PomodoroSession[]
  moodEntries     MoodEntry[]
}

model JobApplication {
  id          String   @id @default(cuid())
  company     String
  position    String
  salary      Int?
  status      JobStatus
  appliedAt   DateTime
  interviewAt DateTime?
  notes       String?
  url         String?
  source      String? // LinkedIn, 104, etc.
  
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([userId, appliedAt])
}

enum JobStatus {
  APPLIED
  INTERVIEW_SCHEDULED
  INTERVIEW_COMPLETED
  OFFER_RECEIVED
  REJECTED
  WITHDRAWN
}
```

#### API 設計規範
```typescript
// RESTful API 設計
GET    /api/jobs              // 獲取求職列表
POST   /api/jobs              // 創建新的求職申請
GET    /api/jobs/[id]         // 獲取特定求職申請
PUT    /api/jobs/[id]         // 更新求職申請
DELETE /api/jobs/[id]         // 刪除求職申請
GET    /api/jobs/stats        // 獲取統計數據

// 查詢參數規範
interface JobQueryParams {
  page?: number       // 分頁
  limit?: number      // 每頁數量 (最大 50)
  status?: JobStatus  // 狀態篩選
  company?: string    // 公司名稱搜尋
  startDate?: string  // 開始日期 (ISO 8601)
  endDate?: string    // 結束日期 (ISO 8601)
  sort?: 'appliedAt' | 'company' | 'position'
  order?: 'asc' | 'desc'
}
```

### 📈 學習進度可視化

#### GitHub API 整合
```typescript
// GitHub 活動追蹤
interface GitHubStats {
  totalCommits: number
  totalRepos: number
  languageStats: Record<string, number>
  contributionCalendar: ContributionDay[]
  recentActivity: GitHubEvent[]
}

// 安全的 GitHub API 調用
const fetchGitHubStats = async (username: string): Promise<GitHubStats> => {
  const octokit = new Octokit({
    auth: process.env.GITHUB_TOKEN, // 服務端環境變數
  })

  try {
    // 使用 GraphQL API 減少請求次數
    const { data } = await octokit.graphql(`
      query getUserStats($username: String!) {
        user(login: $username) {
          contributionsCollection {
            totalCommitContributions
            contributionCalendar {
              weeks {
                contributionDays {
                  date
                  contributionCount
                }
              }
            }
          }
          repositories(first: 100, ownerAffiliations: OWNER) {
            nodes {
              name
              primaryLanguage {
                name
              }
              languages(first: 10) {
                edges {
                  size
                  node {
                    name
                  }
                }
              }
            }
          }
        }
      }
    `, { username })

    return transformGitHubData(data)
  } catch (error) {
    console.error('GitHub API Error:', error)
    throw new Error('Failed to fetch GitHub stats')
  }
}
```

#### LeetCode 整合（非官方 API）
```typescript
// LeetCode 統計追蹤
interface LeetCodeStats {
  totalSolved: number
  easyCount: number
  mediumCount: number
  hardCount: number
  recentSubmissions: Submission[]
  streak: number
}

// 使用 LeetCode GraphQL API（非官方）
const fetchLeetCodeStats = async (username: string): Promise<LeetCodeStats> => {
  const query = `
    query getUserStats($username: String!) {
      matchedUser(username: $username) {
        submitStats: submitStatsGlobal {
          acSubmissionNum {
            difficulty
            count
          }
        }
        recentSubmissionList(limit: 10) {
          title
          timestamp
          statusDisplay
          lang
        }
      }
    }
  `

  try {
    const response = await fetch('https://leetcode.com/graphql', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Referer': 'https://leetcode.com',
      },
      body: JSON.stringify({ query, variables: { username } }),
    })

    if (!response.ok) {
      throw new Error('LeetCode API request failed')
    }

    const data = await response.json()
    return transformLeetCodeData(data)
  } catch (error) {
    console.error('LeetCode API Error:', error)
    // 優雅降級：返回預設值而非崩潰
    return {
      totalSolved: 0,
      easyCount: 0,
      mediumCount: 0,
      hardCount: 0,
      recentSubmissions: [],
      streak: 0,
    }
  }
}
```

### ⏰ 番茄鐘時間管理

#### Hook 設計
```typescript
// usePomodoro Hook
interface PomodoroConfig {
  workDuration: number    // 工作時長（分鐘）
  shortBreak: number      // 短休息時長
  longBreak: number       // 長休息時長
  sessionsUntilLongBreak: number // 長休息間隔
}

interface PomodoroState {
  currentSession: number
  timeLeft: number
  isRunning: boolean
  phase: 'work' | 'shortBreak' | 'longBreak' | 'idle'
  totalSessions: number
  totalWorkTime: number // 累計工作時間（分鐘）
}

const usePomodoro = (config: PomodoroConfig) => {
  const [state, setState] = useState<PomodoroState>(initialState)
  
  // 使用 useCallback 優化性能
  const start = useCallback(() => {
    setState(prev => ({ ...prev, isRunning: true }))
  }, [])
  
  const pause = useCallback(() => {
    setState(prev => ({ ...prev, isRunning: false }))
  }, [])
  
  const reset = useCallback(() => {
    setState(initialState)
  }, [])
  
  const skip = useCallback(() => {
    // 跳到下一個階段
    advanceToNextPhase()
  }, [])
  
  // 計時器邏輯
  useEffect(() => {
    if (!state.isRunning || state.timeLeft === 0) return
    
    const interval = setInterval(() => {
      setState(prev => {
        if (prev.timeLeft <= 1) {
          // 時間到，進入下一階段
          handlePhaseComplete()
          return { ...prev, timeLeft: 0, isRunning: false }
        }
        return { ...prev, timeLeft: prev.timeLeft - 1 }
      })
    }, 1000)
    
    return () => clearInterval(interval)
  }, [state.isRunning, state.timeLeft])
  
  return {
    ...state,
    start,
    pause,
    reset,
    skip,
    formatTime: (seconds: number) => 
      `${Math.floor(seconds / 60):02d}:${seconds % 60:02d}`,
  }
}
```

#### 本地儲存規範
```typescript
// 本地儲存管理
interface PomodoroHistory {
  date: string // YYYY-MM-DD
  sessions: PomodoroSession[]
  totalWorkTime: number
  totalBreakTime: number
}

interface PomodoroSession {
  id: string
  type: 'work' | 'shortBreak' | 'longBreak'
  duration: number // 實際時長（秒）
  plannedDuration: number // 計劃時長（秒）
  startTime: Date
  endTime: Date
  wasCompleted: boolean
  task?: string // 可選的任務描述
}

// 使用 IndexedDB 儲存大量歷史數據
const savePomodoroHistory = async (history: PomodoroHistory) => {
  try {
    const db = await openDB('worksync', 1, {
      upgrade(db) {
        if (!db.objectStoreNames.contains('pomodoro')) {
          const store = db.createObjectStore('pomodoro', { keyPath: 'date' })
          store.createIndex('date', 'date', { unique: true })
        }
      },
    })
    
    await db.put('pomodoro', history)
  } catch (error) {
    console.error('Failed to save pomodoro history:', error)
    // 降級到 localStorage
    localStorage.setItem(
      `pomodoro_${history.date}`, 
      JSON.stringify(history)
    )
  }
}
```

### 😊 情緒追蹤系統

#### 心情指數模型
```typescript
// 情緒追蹤資料模型
model MoodEntry {
  id        String   @id @default(cuid())
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  date      DateTime @db.Date
  mood      Int      // 1-10 心情指數
  anxiety   Int      // 1-10 焦慮程度
  energy    Int      // 1-10 能量水準
  confidence Int     // 1-10 自信程度
  
  // 當日活動記錄
  jobApplications Int @default(0) // 投遞數量
  interviewCount  Int @default(0) // 面試數量
  studyHours     Float @default(0) // 學習時數
  
  notes     String?  // 可選的心情筆記
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  @@unique([userId, date])
  @@index([userId, date])
}

// 心情分析邏輯
interface MoodAnalysis {
  weeklyAverage: number
  monthlyTrend: 'improving' | 'declining' | 'stable'
  correlations: {
    jobApplications: number // 投遞數量與心情的相關性
    interviews: number
    studyTime: number
  }
  suggestions: string[]
}
```

---

## 🎨 UI/UX 設計規範

### 🌈 色彩系統
```typescript
// Tailwind 客製化色彩配置
const colors = {
  // 主色調 - 舒緩藍綠色系
  primary: {
    50: '#f0fdfa',
    100: '#ccfbf1',
    500: '#14b8a6', // 主要品牌色
    600: '#0d9488',
    900: '#134e4a',
  },
  
  // 次要色調 - 溫暖橙色（用於警示與成就）
  secondary: {
    50: '#fff7ed',
    100: '#ffedd5',
    500: '#f97316',
    600: '#ea580c',
  },
  
  // 情緒色彩
  mood: {
    excellent: '#10b981', // 優秀心情
    good: '#3b82f6',      // 良好心情
    neutral: '#6b7280',   // 普通心情
    poor: '#f59e0b',      // 不佳心情
    terrible: '#ef4444',  // 糟糕心情
  },
  
  // 求職狀態色彩
  jobStatus: {
    applied: '#8b5cf6',
    interview: '#f59e0b',
    offer: '#10b981',
    rejected: '#ef4444',
  }
}
```

### 🎭 幽默元素設計規範
```typescript
// 反諷文案系統
const humorousMessages = {
  loading: [
    "正在計算被拒絕的機率...",
    "努力尋找還在招聘的公司...",
    "檢查履歷是否還有錯字...",
    "準備下一次的完美被拒...",
  ],
  
  emptyStates: {
    noApplications: {
      title: "恭喜！",
      subtitle: "你還沒有被任何公司拒絕",
      action: "開始你的被拒之旅",
    },
    noInterviews: {
      title: "面試邀請？什麼是面試邀請？",
      subtitle: "傳說中有一種東西叫做面試邀請",
      action: "繼續投遞履歷",
    },
  },
  
  achievements: [
    "連續被拒絕 5 次 - 堅持不懈獎",
    "單日投遞 10 份履歷 - 海投大師",
    "收到第一個面試邀請 - 奇蹟時刻",
    "心情指數連續 7 天穩定 - 佛系求職者",
  ],
  
  notifications: {
    applicationAdded: "又一份履歷石沉大海...",
    interviewScheduled: "居然有公司要見你？！",
    rejection: "又一次成長的機會！",
  }
}

// 動態文案生成
const generateMotivationalMessage = (stats: JobStats): string => {
  const { totalApplications, interviews, rejections } = stats
  
  if (rejections > interviews * 5) {
    return "你的韌性比橡皮筋還強！"
  }
  
  if (interviews === 0 && totalApplications > 20) {
    return "也許是時候檢查一下垃圾郵件夾了？"
  }
  
  return "每一次拒絕都讓你更接近成功！"
}
```

### 🎬 動畫規範
```typescript
// Framer Motion 動畫變體
const animations = {
  // 頁面轉場動畫
  pageTransition: {
    initial: { opacity: 0, y: 20 },
    animate: { opacity: 1, y: 0 },
    exit: { opacity: 0, y: -20 },
    transition: { duration: 0.3, ease: "easeInOut" }
  },
  
  // 卡片懸停效果
  cardHover: {
    rest: { scale: 1, shadow: "0 4px 6px -1px rgba(0, 0, 0, 0.1)" },
    hover: { 
      scale: 1.02, 
      shadow: "0 20px 25px -5px rgba(0, 0, 0, 0.1)",
      transition: { duration: 0.2 }
    }
  },
  
  // 數據更新動畫
  countUp: {
    initial: { scale: 0.8, opacity: 0 },
    animate: { scale: 1, opacity: 1 },
    transition: { type: "spring", stiffness: 500, damping: 30 }
  },
  
  // 成就解鎖動畫
  achievement: {
    initial: { scale: 0, rotate: -180 },
    animate: { scale: 1, rotate: 0 },
    transition: { type: "spring", stiffness: 300, damping: 20 }
  }
}

// 組件使用範例
const AnimatedCard: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  return (
    <motion.div
      variants={animations.cardHover}
      initial="rest"
      whileHover="hover"
      className="bg-white rounded-lg p-6 shadow-sm"
    >
      {children}
    </motion.div>
  )
}
```

---

## 📱 響應式設計規範

### 📐 斷點系統
```typescript
// Tailwind 斷點配置
const screens = {
  'xs': '475px',
  'sm': '640px',   // 手機橫向
  'md': '768px',   // 平板直向
  'lg': '1024px',  // 平板橫向 / 小筆電
  'xl': '1280px',  // 桌面
  '2xl': '1536px', // 大桌面
}

// 響應式組件設計原則
const ResponsiveGrid: React.FC = () => {
  return (
    <div className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 md:gap-6">
      {/* 手機：1列，平板：2列，桌面：3列 */}
    </div>
  )
}
```

### 📱 PWA 配置
```json
// next.config.js PWA 設定
const withPWA = require('next-pwa')({
  dest: 'public',
  register: true,
  skipWaiting: true,
  runtimeCaching: [
    {
      urlPattern: /^https:\/\/api\.github\.com/,
      handler: 'CacheFirst',
      options: {
        cacheName: 'github-api-cache',
        expiration: {
          maxEntries: 50,
          maxAgeSeconds: 5 * 60, // 5 分鐘
        },
      },
    },
  ],
})
```

---

## 🧪 測試策略

### 🔬 單元測試
```typescript
// Jest + Testing Library 配置
import { render, screen, fireEvent, waitFor } from '@testing-library/react'
import { PomodoroTimer } from '@/components/PomodoroTimer'

describe('PomodoroTimer', () => {
  it('should start timer when start button is clicked', async () => {
    render(<PomodoroTimer />)
    
    const startButton = screen.getByRole('button', { name: /start/i })
    fireEvent.click(startButton)
    
    await waitFor(() => {
      expect(screen.getByText(/running/i)).toBeInTheDocument()
    })
  })
  
  it('should display correct time format', () => {
    render(<PomodoroTimer initialTime={1500} />) // 25 minutes
    
    expect(screen.getByText('25:00')).toBeInTheDocument()
  })
})
```

### 🎭 E2E 測試
```typescript
// Playwright E2E 測試
import { test, expect } from '@playwright/test'

test('complete job application flow', async ({ page }) => {
  await page.goto('/')
  
  // 登入流程
  await page.click('[data-testid="login-button"]')
  await page.fill('[data-testid="email-input"]', 'test@example.com')
  await page.fill('[data-testid="password-input"]', 'password123')
  await page.click('[data-testid="submit-login"]')
  
  // 新增求職申請
  await page.click('[data-testid="add-job-button"]')
  await page.fill('[data-testid="company-input"]', 'Google')
  await page.fill('[data-testid="position-input"]', 'Frontend Engineer')
  await page.selectOption('[data-testid="status-select"]', 'applied')
  await page.click('[data-testid="save-job"]')
  
  // 驗證新增成功
  await expect(page.locator('[data-testid="job-card"]')).toContainText('Google')
})
```

---

## 🚀 部署與監控

### 🌐 Vercel 部署配置
```json
// vercel.json
{
  "framework": "nextjs",
  "buildCommand": "npm run build",
  "devCommand": "npm run dev",
  "installCommand": "npm install",
  "functions": {
    "app/api/**/*.ts": {
      "maxDuration": 30
    }
  },
  "headers": [
    {
      "source": "/api/(.*)",
      "headers": [
        {
          "key": "X-Content-Type-Options",
          "value": "nosniff"
        },
        {
          "key": "X-Frame-Options",
          "value": "DENY"
        },
        {
          "key": "X-XSS-Protection",
          "value": "1; mode=block"
        }
      ]
    }
  ]
}
```

### 📊 效能監控
```typescript
// 使用 Web Vitals 監控效能
import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals'

const sendToAnalytics = (metric: any) => {
  // 發送到分析服務
  console.log(metric)
}

// 監控核心 Web Vitals
getCLS(sendToAnalytics)
getFID(sendToAnalytics)
getFCP(sendToAnalytics)
getLCP(sendToAnalytics)
getTTFB(sendToAnalytics)
```

### 🐛 錯誤監控
```typescript
// Sentry 錯誤追蹤配置
import * as Sentry from '@sentry/nextjs'

Sentry.init({
  dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
  environment: process.env.NODE_ENV,
  tracesSampleRate: 0.1,
  beforeSend(event) {
    // 過濾敏感資訊
    if (event.user) {
      delete event.user.email
    }
    return event
  },
})
```

---

## 📚 開發指南

### 🎯 代碼品質標準

#### ESLint 配置
```json
// .eslintrc.json
{
  "extends": [
    "next/core-web-vitals",
    "@typescript-eslint/recommended",
    "prettier"
  ],
  "rules": {
    "@typescript-eslint/no-unuse